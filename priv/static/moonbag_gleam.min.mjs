var d=class{withFields(t){let r=Object.keys(this).map(n=>n in t?t[n]:this[n]);return new this.constructor(...r)}},We=class{static fromArray(t,r){let n=r||new ve;for(let i=t.length-1;i>=0;--i)n=new fe(t[i],n);return n}[Symbol.iterator](){return new Nr(this)}toArray(){return[...this]}atLeastLength(t){let r=this;for(;t-- >0&&r;)r=r.tail;return r!==void 0}hasLength(t){let r=this;for(;t-- >0&&r;)r=r.tail;return t===-1&&r instanceof ve}countLength(){let t=this,r=0;for(;t;)t=t.tail,r++;return r-1}};function _(e,t){return new fe(e,t)}function l(e,t){return We.fromArray(e,t)}var Nr=class{#e;constructor(t){this.#e=t}next(){if(this.#e instanceof ve)return{done:!0};{let{head:t,tail:r}=this.#e;return this.#e=r,{value:t,done:!1}}}},ve=class extends We{},fe=class extends We{constructor(t,r){super(),this.head=t,this.tail=r}},kt=class{bitSize;byteSize;bitOffset;rawBuffer;constructor(t,r,n){if(!(t instanceof Uint8Array))throw globalThis.Error("BitArray can only be constructed from a Uint8Array");if(this.bitSize=r??t.length*8,this.byteSize=Math.trunc((this.bitSize+7)/8),this.bitOffset=n??0,this.bitSize<0)throw globalThis.Error(`BitArray bit size is invalid: ${this.bitSize}`);if(this.bitOffset<0||this.bitOffset>7)throw globalThis.Error(`BitArray bit offset is invalid: ${this.bitOffset}`);if(t.length!==Math.trunc((this.bitOffset+this.bitSize+7)/8))throw globalThis.Error("BitArray buffer length is invalid");this.rawBuffer=t}byteAt(t){if(!(t<0||t>=this.byteSize))return yt(this.rawBuffer,this.bitOffset,t)}equals(t){if(this.bitSize!==t.bitSize)return!1;let r=Math.trunc(this.bitSize/8);if(this.bitOffset===0&&t.bitOffset===0){for(let i=0;i<r;i++)if(this.rawBuffer[i]!==t.rawBuffer[i])return!1;let n=this.bitSize%8;if(n){let i=8-n;if(this.rawBuffer[r]>>i!==t.rawBuffer[r]>>i)return!1}}else{for(let i=0;i<r;i++){let s=yt(this.rawBuffer,this.bitOffset,i),o=yt(t.rawBuffer,t.bitOffset,i);if(s!==o)return!1}let n=this.bitSize%8;if(n){let i=yt(this.rawBuffer,this.bitOffset,r),s=yt(t.rawBuffer,t.bitOffset,r),o=8-n;if(i>>o!==s>>o)return!1}}return!0}get buffer(){if(xi("buffer","Use BitArray.byteAt() or BitArray.rawBuffer instead"),this.bitOffset!==0||this.bitSize%8!==0)throw new globalThis.Error("BitArray.buffer does not support unaligned bit arrays");return this.rawBuffer}get length(){if(xi("length","Use BitArray.bitSize or BitArray.byteSize instead"),this.bitOffset!==0||this.bitSize%8!==0)throw new globalThis.Error("BitArray.length does not support unaligned bit arrays");return this.rawBuffer.length}};function yt(e,t,r){if(t===0)return e[r]??0;{let n=e[r]<<t&255,i=e[r+1]>>8-t;return n|i}}var hi={};function xi(e,t){hi[e]||(console.warn(`Deprecated BitArray.${e} property used in JavaScript FFI code. ${t}.`),hi[e]=!0)}var vt=class e extends d{static isResult(t){return t instanceof e}},N=class extends vt{constructor(t){super(),this[0]=t}isOk(){return!0}},C=class extends vt{constructor(t){super(),this[0]=t}isOk(){return!1}};function I(e,t){let r=[e,t];for(;r.length;){let n=r.pop(),i=r.pop();if(n===i)continue;if(!$i(n)||!$i(i)||!xo(n,i)||co(n,i)||fo(n,i)||po(n,i)||_o(n,i)||mo(n,i)||ho(n,i))return!1;let o=Object.getPrototypeOf(n);if(o!==null&&typeof o.equals=="function")try{if(n.equals(i))continue;return!1}catch{}let[u,a]=ao(n);for(let c of u(n))r.push(a(n,c),a(i,c))}return!0}function ao(e){if(e instanceof Map)return[t=>t.keys(),(t,r)=>t.get(r)];{let t=e instanceof globalThis.Error?["message"]:[];return[r=>[...t,...Object.keys(r)],(r,n)=>r[n]]}}function co(e,t){return e instanceof Date&&(e>t||e<t)}function fo(e,t){return!(e instanceof kt)&&e.buffer instanceof ArrayBuffer&&e.BYTES_PER_ELEMENT&&!(e.byteLength===t.byteLength&&e.every((r,n)=>r===t[n]))}function po(e,t){return Array.isArray(e)&&e.length!==t.length}function _o(e,t){return e instanceof Map&&e.size!==t.size}function mo(e,t){return e instanceof Set&&(e.size!=t.size||[...e].some(r=>!t.has(r)))}function ho(e,t){return e instanceof RegExp&&(e.source!==t.source||e.flags!==t.flags)}function $i(e){return typeof e=="object"&&e!==null}function xo(e,t){return typeof e!="object"&&typeof t!="object"&&(!e||!t)||[Promise,WeakSet,WeakMap,Function].some(n=>e instanceof n)?!1:e.constructor===t.constructor}function Mr(e,t,r,n,i,s){let o=new globalThis.Error(i);o.gleam_error=e,o.module=t,o.line=r,o.function=n,o.fn=n;for(let u in s)o[u]=s[u];return o}var P=class extends d{},M=class extends d{},V=class extends d{};var se=class extends d{constructor(t){super(),this[0]=t}},ee=class extends d{};var wi=new WeakMap,Ir=new DataView(new ArrayBuffer(8)),qr=0;function Ur(e){let t=wi.get(e);if(t!==void 0)return t;let r=qr++;return qr===2147483647&&(qr=0),wi.set(e,r),r}function Pr(e,t){return e^t+2654435769+(e<<6)+(e>>2)|0}function Fr(e){let t=0,r=e.length;for(let n=0;n<r;n++)t=Math.imul(31,t)+e.charCodeAt(n)|0;return t}function gi(e){Ir.setFloat64(0,e);let t=Ir.getInt32(0),r=Ir.getInt32(4);return Math.imul(73244475,t>>16^t)^r}function $o(e){return Fr(e.toString())}function wo(e){let t=Object.getPrototypeOf(e);if(t!==null&&typeof t.hashCode=="function")try{let n=e.hashCode(e);if(typeof n=="number")return n}catch{}if(e instanceof Promise||e instanceof WeakSet||e instanceof WeakMap)return Ur(e);if(e instanceof Date)return gi(e.getTime());let r=0;if(e instanceof ArrayBuffer&&(e=new Uint8Array(e)),Array.isArray(e)||e instanceof Uint8Array)for(let n=0;n<e.length;n++)r=Math.imul(31,r)+he(e[n])|0;else if(e instanceof Set)e.forEach(n=>{r=r+he(n)|0});else if(e instanceof Map)e.forEach((n,i)=>{r=r+Pr(he(n),he(i))|0});else{let n=Object.keys(e);for(let i=0;i<n.length;i++){let s=n[i],o=e[s];r=r+Pr(he(o),Fr(s))|0}}return r}function he(e){if(e===null)return 1108378658;if(e===void 0)return 1108378659;if(e===!0)return 1108378657;if(e===!1)return 1108378656;switch(typeof e){case"number":return gi(e);case"string":return Fr(e);case"bigint":return $o(e);case"object":return wo(e);case"symbol":return Ur(e);case"function":return Ur(e);default:return 0}}var Ae=5,Rr=Math.pow(2,Ae),bo=Rr-1,go=Rr/2,yo=Rr/4,oe=0,Se=1,pe=2,Ye=3,Gr={type:pe,bitmap:0,array:[]};function Lt(e,t){return e>>>t&bo}function tr(e,t){return 1<<Lt(e,t)}function ko(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),e=e+(e>>4)&252645135,e+=e>>8,e+=e>>16,e&127}function Hr(e,t){return ko(e&t-1)}function xe(e,t,r){let n=e.length,i=new Array(n);for(let s=0;s<n;++s)i[s]=e[s];return i[t]=r,i}function vo(e,t,r){let n=e.length,i=new Array(n+1),s=0,o=0;for(;s<t;)i[o++]=e[s++];for(i[o++]=r;s<n;)i[o++]=e[s++];return i}function Dr(e,t){let r=e.length,n=new Array(r-1),i=0,s=0;for(;i<t;)n[s++]=e[i++];for(++i;i<r;)n[s++]=e[i++];return n}function yi(e,t,r,n,i,s){let o=he(t);if(o===n)return{type:Ye,hash:o,array:[{type:oe,k:t,v:r},{type:oe,k:i,v:s}]};let u={val:!1};return Ot(Vr(Gr,e,o,t,r,u),e,n,i,s,u)}function Ot(e,t,r,n,i,s){switch(e.type){case Se:return jo(e,t,r,n,i,s);case pe:return Vr(e,t,r,n,i,s);case Ye:return Lo(e,t,r,n,i,s)}}function jo(e,t,r,n,i,s){let o=Lt(r,t),u=e.array[o];if(u===void 0)return s.val=!0,{type:Se,size:e.size+1,array:xe(e.array,o,{type:oe,k:n,v:i})};if(u.type===oe)return I(n,u.k)?i===u.v?e:{type:Se,size:e.size,array:xe(e.array,o,{type:oe,k:n,v:i})}:(s.val=!0,{type:Se,size:e.size,array:xe(e.array,o,yi(t+Ae,u.k,u.v,r,n,i))});let a=Ot(u,t+Ae,r,n,i,s);return a===u?e:{type:Se,size:e.size,array:xe(e.array,o,a)}}function Vr(e,t,r,n,i,s){let o=tr(r,t),u=Hr(e.bitmap,o);if((e.bitmap&o)!==0){let a=e.array[u];if(a.type!==oe){let f=Ot(a,t+Ae,r,n,i,s);return f===a?e:{type:pe,bitmap:e.bitmap,array:xe(e.array,u,f)}}let c=a.k;return I(n,c)?i===a.v?e:{type:pe,bitmap:e.bitmap,array:xe(e.array,u,{type:oe,k:n,v:i})}:(s.val=!0,{type:pe,bitmap:e.bitmap,array:xe(e.array,u,yi(t+Ae,c,a.v,r,n,i))})}else{let a=e.array.length;if(a>=go){let c=new Array(32),f=Lt(r,t);c[f]=Vr(Gr,t+Ae,r,n,i,s);let $=0,h=e.bitmap;for(let x=0;x<32;x++){if((h&1)!==0){let m=e.array[$++];c[x]=m}h=h>>>1}return{type:Se,size:a+1,array:c}}else{let c=vo(e.array,u,{type:oe,k:n,v:i});return s.val=!0,{type:pe,bitmap:e.bitmap|o,array:c}}}}function Lo(e,t,r,n,i,s){if(r===e.hash){let o=Wr(e,n);if(o!==-1)return e.array[o].v===i?e:{type:Ye,hash:r,array:xe(e.array,o,{type:oe,k:n,v:i})};let u=e.array.length;return s.val=!0,{type:Ye,hash:r,array:xe(e.array,u,{type:oe,k:n,v:i})}}return Ot({type:pe,bitmap:tr(e.hash,t),array:[e]},t,r,n,i,s)}function Wr(e,t){let r=e.array.length;for(let n=0;n<r;n++)if(I(t,e.array[n].k))return n;return-1}function er(e,t,r,n){switch(e.type){case Se:return Oo(e,t,r,n);case pe:return Eo(e,t,r,n);case Ye:return So(e,n)}}function Oo(e,t,r,n){let i=Lt(r,t),s=e.array[i];if(s!==void 0){if(s.type!==oe)return er(s,t+Ae,r,n);if(I(n,s.k))return s}}function Eo(e,t,r,n){let i=tr(r,t);if((e.bitmap&i)===0)return;let s=Hr(e.bitmap,i),o=e.array[s];if(o.type!==oe)return er(o,t+Ae,r,n);if(I(n,o.k))return o}function So(e,t){let r=Wr(e,t);if(!(r<0))return e.array[r]}function Yr(e,t,r,n){switch(e.type){case Se:return Ao(e,t,r,n);case pe:return Bo(e,t,r,n);case Ye:return Co(e,n)}}function Ao(e,t,r,n){let i=Lt(r,t),s=e.array[i];if(s===void 0)return e;let o;if(s.type===oe){if(!I(s.k,n))return e}else if(o=Yr(s,t+Ae,r,n),o===s)return e;if(o===void 0){if(e.size<=yo){let u=e.array,a=new Array(e.size-1),c=0,f=0,$=0;for(;c<i;){let h=u[c];h!==void 0&&(a[f]=h,$|=1<<c,++f),++c}for(++c;c<u.length;){let h=u[c];h!==void 0&&(a[f]=h,$|=1<<c,++f),++c}return{type:pe,bitmap:$,array:a}}return{type:Se,size:e.size-1,array:xe(e.array,i,o)}}return{type:Se,size:e.size,array:xe(e.array,i,o)}}function Bo(e,t,r,n){let i=tr(r,t);if((e.bitmap&i)===0)return e;let s=Hr(e.bitmap,i),o=e.array[s];if(o.type!==oe){let u=Yr(o,t+Ae,r,n);return u===o?e:u!==void 0?{type:pe,bitmap:e.bitmap,array:xe(e.array,s,u)}:e.bitmap===i?void 0:{type:pe,bitmap:e.bitmap^i,array:Dr(e.array,s)}}return I(n,o.k)?e.bitmap===i?void 0:{type:pe,bitmap:e.bitmap^i,array:Dr(e.array,s)}:e}function Co(e,t){let r=Wr(e,t);if(r<0)return e;if(e.array.length!==1)return{type:Ye,hash:e.hash,array:Dr(e.array,r)}}function ki(e,t){if(e===void 0)return;let r=e.array,n=r.length;for(let i=0;i<n;i++){let s=r[i];if(s!==void 0){if(s.type===oe){t(s.v,s.k);continue}ki(s,t)}}}var De=class e{static fromObject(t){let r=Object.keys(t),n=e.new();for(let i=0;i<r.length;i++){let s=r[i];n=n.set(s,t[s])}return n}static fromMap(t){let r=e.new();return t.forEach((n,i)=>{r=r.set(i,n)}),r}static new(){return new e(void 0,0)}constructor(t,r){this.root=t,this.size=r}get(t,r){if(this.root===void 0)return r;let n=er(this.root,0,he(t),t);return n===void 0?r:n.v}set(t,r){let n={val:!1},i=this.root===void 0?Gr:this.root,s=Ot(i,0,he(t),t,r,n);return s===this.root?this:new e(s,n.val?this.size+1:this.size)}delete(t){if(this.root===void 0)return this;let r=Yr(this.root,0,he(t),t);return r===this.root?this:r===void 0?e.new():new e(r,this.size-1)}has(t){return this.root===void 0?!1:er(this.root,0,he(t),t)!==void 0}entries(){if(this.root===void 0)return[];let t=[];return this.forEach((r,n)=>t.push([n,r])),t}forEach(t){ki(this.root,t)}hashCode(){let t=0;return this.forEach((r,n)=>{t=t+Pr(he(r),he(n))|0}),t}equals(t){if(!(t instanceof e)||this.size!==t.size)return!1;try{return this.forEach((r,n)=>{if(!I(t.get(n,!r),r))throw bi}),!0}catch(r){if(r===bi)return!1;throw r}}},bi=Symbol();var zo=void 0,vi={};function W(e){return e.toString()}function Jr(e,t){return e.startsWith(t)}var ji=[" ","	",`
`,"\v","\f","\r","\x85","\u2028","\u2029"].join(""),Tl=new RegExp(`^[${ji}]*`),zl=new RegExp(`[${ji}]*$`);function Et(){let e=Math.random();return e===1?Et():e}function St(){return De.new()}function At(e,t){let r=e.get(t,vi);return r===vi?new C(zo):new N(r)}function Li(e,t,r){return r.set(e,t)}function Ei(e,t){return e===t?new M:e<t?new P:new V}function Bi(e,t){return e===t?new M:e<t?new P:new V}function Bt(e,t,r){return Li(t,r,e)}var D=class extends d{},Be=class extends d{};function Xe(e,t){for(;;){let r=e,n=t;if(r.hasLength(0))return n;{let i=r.head;e=r.tail,t=_(i,n)}}}function Y(e){return Xe(e,l([]))}function Ti(e){return I(e,l([]))}function Fo(e,t,r){for(;;){let n=e,i=t,s=r;if(n.hasLength(0))return Y(s);{let o=n.head;e=n.tail,t=i,r=_(i(o),s)}}}function Ce(e,t){return Fo(e,t,l([]))}function Ro(e,t,r,n){for(;;){let i=e,s=t,o=r,u=n;if(i.hasLength(0))return Y(u);{let a=i.head,c=i.tail,f=_(s(a,o),u);e=c,t=s,r=o+1,n=f}}}function zi(e,t){return Ro(e,t,0,l([]))}function Go(e,t){for(;;){let r=e,n=t;if(r.hasLength(0))return n;{let i=r.head;e=r.tail,t=_(i,n)}}}function je(e,t){return Go(Y(e),t)}function Ct(e,t){return _(t,e)}function Ho(e,t){for(;;){let r=e,n=t;if(r.hasLength(0))return Y(n);{let i=r.head;e=r.tail,t=Xe(i,n)}}}function Xr(e){return Ho(e,l([]))}function de(e,t,r){for(;;){let n=e,i=t,s=r;if(n.hasLength(0))return i;{let o=n.head;e=n.tail,t=s(i,o),r=s}}}function Vo(e,t,r,n,i,s){for(;;){let o=e,u=t,a=r,c=n,f=i,$=s,h=_(f,a);if(o.hasLength(0))return c instanceof D?_(Y(h),$):_(h,$);{let x=o.head,m=o.tail,k=u(f,x);if(k instanceof V&&c instanceof Be)e=m,t=u,r=h,n=c,i=x,s=$;else if(k instanceof P&&c instanceof D)e=m,t=u,r=h,n=c,i=x,s=$;else if(k instanceof M&&c instanceof D)e=m,t=u,r=h,n=c,i=x,s=$;else if(k instanceof V&&c instanceof D){let p;c instanceof D?p=_(Y(h),$):p=_(h,$);let g=p;if(m.hasLength(0))return _(l([x]),g);{let b=m.head,v=m.tail,y,w=u(x,b);w instanceof P?y=new D:w instanceof M?y=new D:y=new Be;let j=y;e=v,t=u,r=l([x]),n=j,i=b,s=g}}else if(k instanceof P&&c instanceof Be){let p;c instanceof D?p=_(Y(h),$):p=_(h,$);let g=p;if(m.hasLength(0))return _(l([x]),g);{let b=m.head,v=m.tail,y,w=u(x,b);w instanceof P?y=new D:w instanceof M?y=new D:y=new Be;let j=y;e=v,t=u,r=l([x]),n=j,i=b,s=g}}else{let p;c instanceof D?p=_(Y(h),$):p=_(h,$);let g=p;if(m.hasLength(0))return _(l([x]),g);{let b=m.head,v=m.tail,y,w=u(x,b);w instanceof P?y=new D:w instanceof M?y=new D:y=new Be;let j=y;e=v,t=u,r=l([x]),n=j,i=b,s=g}}}}}function Wo(e,t,r,n){for(;;){let i=e,s=t,o=r,u=n;if(i.hasLength(0))return Xe(s,u);if(s.hasLength(0))return Xe(i,u);{let a=i.head,c=i.tail,f=s.head,$=s.tail,h=o(a,f);h instanceof P?(e=c,t=s,r=o,n=_(a,u)):h instanceof V?(e=i,t=$,r=o,n=_(f,u)):(e=i,t=$,r=o,n=_(f,u))}}}function Yo(e,t,r){for(;;){let n=e,i=t,s=r;if(n.hasLength(0))return Y(s);if(n.hasLength(1)){let o=n.head;return Y(_(Y(o),s))}else{let o=n.head,u=n.tail.head,a=n.tail.tail,c=Wo(o,u,i,l([]));e=a,t=i,r=_(c,s)}}}function Jo(e,t,r,n){for(;;){let i=e,s=t,o=r,u=n;if(i.hasLength(0))return Xe(s,u);if(s.hasLength(0))return Xe(i,u);{let a=i.head,c=i.tail,f=s.head,$=s.tail,h=o(a,f);h instanceof P?(e=i,t=$,r=o,n=_(f,u)):h instanceof V?(e=c,t=s,r=o,n=_(a,u)):(e=c,t=s,r=o,n=_(a,u))}}}function Xo(e,t,r){for(;;){let n=e,i=t,s=r;if(n.hasLength(0))return Y(s);if(n.hasLength(1)){let o=n.head;return Y(_(Y(o),s))}else{let o=n.head,u=n.tail.head,a=n.tail.tail,c=Jo(o,u,i,l([]));e=a,t=i,r=_(c,s)}}}function Ko(e,t,r){for(;;){let n=e,i=t,s=r;if(n.hasLength(0))return l([]);if(n.hasLength(1)&&i instanceof D)return n.head;if(n.hasLength(1)&&i instanceof Be){let o=n.head;return Y(o)}else i instanceof D?(e=Yo(n,s,l([])),t=new Be,r=s):(e=Xo(n,s,l([])),t=new D,r=s)}}function Kr(e,t){if(e.hasLength(0))return l([]);if(e.hasLength(1)){let r=e.head;return l([r])}else{let r=e.head,n=e.tail.head,i=e.tail.tail,s,o=t(r,n);o instanceof P?s=new D:o instanceof M?s=new D:s=new Be;let u=s,a=Vo(i,t,l([r]),u,n,l([]));return Ko(a,new D,t)}}function Qo(e,t,r){for(;;){let n=e,i=t,s=r,o=Bi(n,i);if(o instanceof M)return _(i,s);o instanceof V?(e=n,t=i+1,r=_(i,s)):(e=n,t=i-1,r=_(i,s))}}function Ni(e,t){return Qo(e,t,l([]))}function Zo(e,t,r){for(;;){let n=e,i=t,s=r;if(i<=0)return s;e=n,t=i-1,r=_(n,s)}}function Mi(e,t){return Zo(e,t,l([]))}function eu(e,t,r){for(;;){let n=e,i=t,s=r;if(n.hasLength(0))return new C(void 0);if(n.atLeastLength(1)&&I(n.head[0],i)){let o=n.head[0],u=n.head[1],a=n.tail;return new N([u,Xe(s,a)])}else{let o=n.head;e=n.tail,t=i,r=_(o,s)}}}function Ii(e,t){return eu(e,t,l([]))}function tu(e,t){for(;;){let r=e,n=t;if(r.hasLength(0))return n;{let i=r.head;e=r.tail,t=_(i[1],n)}}}function ru(e){return Kr(e,(t,r)=>Ei(t[0],r[0]))}function Qr(e){let r=de(e,l([]),(i,s)=>_([Et(),s],i)),n=ru(r);return tu(n,l([]))}function cu(e,t){for(;;){let r=e,n=t;if(r.atLeastLength(1)){let i=r.head;e=r.tail,t=n+i}else return n}}function rr(e){return cu(e,"")}function qi(e){return!!e.isOk()}var nr=class extends d{constructor(t){super(),this.function=t}};function ut(e,t){let r=t.function(e),n=r[0],i=r[1];return i.hasLength(0)?new N(n):new C(i)}function en(e){return new nr(t=>[e,l([])])}function tn(e,t){return new nr(r=>{let n=e.function(r),i=n[0],s=n[1];return[t(i),s]})}function Fi(e,t,r){return e?t:r()}function le(e){return e}var sr=class extends d{constructor(t){super(),this.dict=t}};function Gi(){return new sr(St())}function nn(e,t){let r=e.dict,n=At(r,t);return qi(n)}var yu=void 0;function Hi(e,t){return new sr(Bt(e.dict,t,yu))}var vu=De.new();function or(){return vu}var ju=Gi();function It(){return ju}var Le=globalThis?.document,ur="http://www.w3.org/1999/xhtml",lr=1,ar=3,qt=11,Vi=!!globalThis.HTMLElement?.prototype?.moveBefore;var S=l([]),cr=new ee;var Lu=new V,Ou=new P,Eu=new M;function fr(e,t){return e.name===t.name?Eu:e.name<t.name?Ou:Lu}var we=class extends d{constructor(t,r,n){super(),this.kind=t,this.name=r,this.value=n}},Ut=class extends d{constructor(t,r,n){super(),this.kind=t,this.name=r,this.value=n}},te=class extends d{constructor(t,r,n,i,s,o,u,a){super(),this.kind=t,this.name=r,this.handler=n,this.include=i,this.prevent_default=s,this.stop_propagation=o,this.immediate=u,this.limit=a}},lt=class extends d{constructor(t){super(),this.kind=t}},Pt=class extends d{constructor(t,r){super(),this.kind=t,this.delay=r}},Dt=class extends d{constructor(t,r){super(),this.kind=t,this.delay=r}};function es(e,t){if(e instanceof lt&&t instanceof lt)return!0;if(e instanceof Pt&&t instanceof Pt&&e.delay===t.delay){let r=e.delay,n=t.delay;return!0}else if(e instanceof Dt&&t instanceof Dt&&e.delay===t.delay){let r=e.delay,n=t.delay;return!0}else return!1}function Cu(e,t){for(;;){let r=e,n=t;if(r.hasLength(0))return n;if(r.atLeastLength(2)&&r.head instanceof we&&r.head.name==="class"&&r.tail.head instanceof we&&r.tail.head.name==="class"){let i=r.head.kind,s=r.head.value,o=r.tail.head.value,u=r.tail.tail,a=s+" "+o,c=new we(i,"class",a);e=_(c,u),t=n}else if(r.atLeastLength(2)&&r.head instanceof we&&r.head.name==="style"&&r.tail.head instanceof we&&r.tail.head.name==="style"){let i=r.head.kind,s=r.head.value,o=r.tail.head.value,u=r.tail.tail,a=s+";"+o,c=new we(i,"style",a);e=_(c,u),t=n}else{let i=r.head;e=r.tail,t=_(i,n)}}}function ts(e){if(e.hasLength(0))return e;if(e.hasLength(1))return e;{let r=Kr(e,(n,i)=>fr(i,n));return Cu(r,S)}}var ln=0;function rs(e,t){return new we(ln,e,t)}var ns=1;var an=2;function is(e,t,r,n,i,s,o){return new te(an,e,t,r,n,i,s,o)}var cn=1;var fn=2;function pr(e,t){return rs(e,t)}function A(e){return pr("class",e)}var pn=class extends d{constructor(t,r,n){super(),this.synchronous=t,this.before_paint=r,this.after_paint=n}};var zu=new pn(l([]),l([]),l([]));function dn(){return zu}function _e(){return null}function at(e,t){let r=e?.get(t);return r!=null?new N(r):new C(void 0)}function Rt(e,t,r){return e??=new Map,e.set(t,r),e}function mn(e,t){return e?.delete(t),e}var _r=class extends d{},mr=class extends d{constructor(t,r){super(),this.key=t,this.parent=r}},hn=class extends d{constructor(t,r){super(),this.index=t,this.parent=r}};function Nu(e,t){for(;;){let r=e,n=t;if(n.hasLength(0))return!1;{let i=n.head,s=n.tail;if(Jr(r,i))return!0;e=r,t=s}}}function Re(e,t,r){return r===""?new hn(t,e):new mr(r,e)}var xn=new _r,$n=`
`,wn="	";function us(e,t){for(;;){let r=e,n=t;if(r instanceof _r){if(n.hasLength(0))return"";{let i=n.tail;return rr(i)}}else if(r instanceof mr){let i=r.key;e=r.parent,t=_(wn,_(i,n))}else{let i=r.index;e=r.parent,t=_($n,_(W(i),n))}}}function Mu(e){return us(e,l([]))}function ls(e,t){return t.hasLength(0)?!1:Nu(Mu(e),t)}var bn="\f";function gn(e,t){return us(e,l([bn,t]))}var ue=class extends d{constructor(t,r,n,i,s,o){super(),this.kind=t,this.key=r,this.mapper=n,this.children=i,this.keyed_children=s,this.children_count=o}},be=class extends d{constructor(t,r,n,i,s,o,u,a,c,f){super(),this.kind=t,this.key=r,this.mapper=n,this.namespace=i,this.tag=s,this.attributes=o,this.children=u,this.keyed_children=a,this.self_closing=c,this.void=f}},Te=class extends d{constructor(t,r,n,i){super(),this.kind=t,this.key=r,this.mapper=n,this.content=i}},Oe=class extends d{constructor(t,r,n,i,s,o,u){super(),this.kind=t,this.key=r,this.mapper=n,this.namespace=i,this.tag=s,this.attributes=o,this.inner_html=u}};function Uu(e,t){return t===""?e==="area"||e==="base"||e==="br"||e==="col"||e==="embed"||e==="hr"||e==="img"||e==="input"||e==="link"||e==="meta"||e==="param"||e==="source"||e==="track"?!0:e==="wbr":!1}function me(e){return e instanceof ue?1+e.children_count:1}var yn=0;function cs(e,t,r,n,i){return new ue(yn,e,t,r,n,i)}var kn=1;function vn(e,t,r,n,i,s,o,u,a){return new be(kn,e,t,r,n,ts(i),s,o,u,a||Uu(n,r))}var jn=2;function Ln(e,t,r){return new Te(jn,e,t,r)}var fs=3;function ps(e,t,r,n,i){for(;;){let s=e,o=t,u=r,a=n,c=i;if(o.hasLength(0))return[Y(a),c];if(o.atLeastLength(1)&&o.head instanceof ue&&o.head.key===""){let f=o.head,$=o.tail,h=s+"::"+W(u),x=ps(h,f.children,0,S,_e()),m=x[0],k=x[1],p,g=f;p=new ue(g.kind,g.key,g.mapper,m,k,g.children_count);let v=_(p,a),y=u+1;e=s,t=$,r=y,n=v,i=c}else if(o.atLeastLength(1)&&o.head.key!==""){let f=o.head,$=o.tail,h=s+"::"+f.key,x=On(h,f),m=_(x,a),k=Rt(c,h,x),p=u+1;e=s,t=$,r=p,n=m,i=k}else{let f=o.head,$=o.tail,h=_(f,a),x=u+1;e=s,t=$,r=x,n=h,i=c}}}function On(e,t){if(t instanceof be){let r=t;return new be(r.kind,e,r.mapper,r.namespace,r.tag,r.attributes,r.children,r.keyed_children,r.self_closing,r.void)}else if(t instanceof Te){let r=t;return new Te(r.kind,e,r.mapper,r.content)}else if(t instanceof Oe){let r=t;return new Oe(r.kind,e,r.mapper,r.namespace,r.tag,r.attributes,r.inner_html)}else{let r=t.children,n=ps(e,r,0,S,_e()),i=n[0],s=n[1],o=t;return new ue(o.kind,e,o.mapper,i,s,o.children_count)}}var Ke=class extends d{constructor(t,r,n,i){super(),this.index=t,this.removed=r,this.changes=n,this.children=i}},En=class extends d{constructor(t,r){super(),this.kind=t,this.content=r}},Sn=class extends d{constructor(t,r){super(),this.kind=t,this.inner_html=r}},An=class extends d{constructor(t,r,n){super(),this.kind=t,this.added=r,this.removed=n}},Bn=class extends d{constructor(t,r,n,i){super(),this.kind=t,this.key=r,this.before=n,this.count=i}},Cn=class extends d{constructor(t,r,n){super(),this.kind=t,this.key=r,this.count=n}},Tn=class extends d{constructor(t,r,n,i){super(),this.kind=t,this.from=r,this.count=n,this.with=i}},zn=class extends d{constructor(t,r,n){super(),this.kind=t,this.children=r,this.before=n}},Nn=class extends d{constructor(t,r,n){super(),this.kind=t,this.from=r,this.count=n}};function Mn(e,t,r,n){return new Ke(e,t,r,n)}var In=0;function ds(e){return new En(In,e)}var qn=1;function _s(e){return new Sn(qn,e)}var Un=2;function Pn(e,t){return new An(Un,e,t)}var hr=3;function ms(e,t,r){return new Bn(hr,e,t,r)}var Dn=4;function hs(e,t){return new Cn(Dn,e,t)}var xr=5;function Fn(e,t,r){return new Tn(xr,e,t,r)}var $r=6;function Rn(e,t){return new zn($r,e,t)}var wr=7;function xs(e,t){return new Nn(wr,e,t)}var kr=class extends d{constructor(t,r){super(),this.patch=t,this.events=r}},Gn=class extends d{constructor(t,r,n){super(),this.added=t,this.removed=r,this.events=n}};function Du(e,t,r,n){return r==="input"&&t===""?gr(e,n):r==="select"&&t===""?gr(e,n):r==="textarea"&&t===""?gr(e,n):!1}function ws(e,t,r,n,i,s,o,u){for(;;){let a=e,c=t,f=r,$=n,h=i,x=s,m=o,k=u;if(h.hasLength(0)&&x.hasLength(0))return new Gn(m,k,$);if(h.atLeastLength(1)&&h.head instanceof te&&x.hasLength(0)){let p=h.head,g=h.head.name,b=h.tail,v=_(p,k),y=br($,c,g);e=a,t=c,r=f,n=y,i=b,s=x,o=m,u=v}else if(h.atLeastLength(1)&&x.hasLength(0)){let p=h.head,g=h.tail,b=_(p,k);e=a,t=c,r=f,n=$,i=g,s=x,o=m,u=b}else if(h.hasLength(0)&&x.atLeastLength(1)&&x.head instanceof te){let p=x.head,g=x.head.name,b=x.head.handler,v=x.tail,y=_(p,m),w=Ht($,f,c,g,b);e=a,t=c,r=f,n=w,i=h,s=v,o=y,u=k}else if(h.hasLength(0)&&x.atLeastLength(1)){let p=x.head,g=x.tail,b=_(p,m);e=a,t=c,r=f,n=$,i=h,s=g,o=b,u=k}else{let p=h.head,g=h.tail,b=x.head,v=x.tail,y=fr(p,b);if(p instanceof we&&y instanceof M&&b instanceof we){let w,j=b.name;j==="value"||j==="checked"||j==="selected"?w=a||p.value!==b.value:w=p.value!==b.value;let O=w,E;O?E=_(b,m):E=m;let T=E;e=a,t=c,r=f,n=$,i=g,s=v,o=T,u=k}else if(p instanceof Ut&&y instanceof M&&b instanceof Ut){let w,j=b.name;j==="scrollLeft"||j==="scrollRight"?w=!0:j==="value"?w=a||!I(p.value,b.value):j==="checked"?w=a||!I(p.value,b.value):j==="selected"?w=a||!I(p.value,b.value):w=!I(p.value,b.value);let O=w,E;O?E=_(b,m):E=m;let T=E;e=a,t=c,r=f,n=$,i=g,s=v,o=T,u=k}else if(p instanceof te&&y instanceof M&&b instanceof te){let w=b.name,j=b.handler,O=p.prevent_default!==b.prevent_default||p.stop_propagation!==b.stop_propagation||p.immediate!==b.immediate||!es(p.limit,b.limit),E;O?E=_(b,m):E=m;let T=E,q=Ht($,f,c,w,j);e=a,t=c,r=f,n=q,i=g,s=v,o=T,u=k}else if(p instanceof te&&y instanceof M){let w=p.name,j=_(b,m),O=_(p,k),E=br($,c,w);e=a,t=c,r=f,n=E,i=g,s=v,o=j,u=O}else if(y instanceof M&&b instanceof te){let w=b.name,j=b.handler,O=_(b,m),E=_(p,k),T=Ht($,f,c,w,j);e=a,t=c,r=f,n=T,i=g,s=v,o=O,u=E}else if(y instanceof M){let w=_(b,m),j=_(p,k);e=a,t=c,r=f,n=$,i=g,s=v,o=w,u=j}else if(y instanceof V&&b instanceof te){let w=b.name,j=b.handler,O=_(b,m),E=Ht($,f,c,w,j);e=a,t=c,r=f,n=E,i=h,s=v,o=O,u=k}else if(y instanceof V){let w=_(b,m);e=a,t=c,r=f,n=$,i=h,s=v,o=w,u=k}else if(p instanceof te&&y instanceof P){let w=p.name,j=_(p,k),O=br($,c,w);e=a,t=c,r=f,n=O,i=g,s=x,o=m,u=j}else{let w=_(p,k);e=a,t=c,r=f,n=$,i=g,s=x,o=m,u=w}}}}function Hn(e,t,r,n,i,s,o,u,a,c,f,$,h,x){for(;;){let m=e,k=t,p=r,g=n,b=i,v=s,y=o,w=u,j=a,O=c,E=f,T=$,q=h,re=x;if(m.hasLength(0)&&p.hasLength(0))return new kr(new Ke(j,y,E,T),re);if(m.atLeastLength(1)&&p.hasLength(0)){let B=m.head,G=m.tail,L;B.key===""||!nn(b,B.key)?L=y+me(B):L=y;let H=L,Q=Vt(re,O,w,B);e=G,t=k,r=p,n=g,i=b,s=v,o=H,u=w,a=j,c=O,f=E,$=T,h=q,x=Q}else if(m.hasLength(0)&&p.atLeastLength(1)){let B=gs(re,q,O,w,p),G=Rn(p,w-v),L=_(G,E);return new kr(new Ke(j,y,L,T),B)}else if(m.atLeastLength(1)&&p.atLeastLength(1)&&m.head.key!==p.head.key){let B=m.head,G=m.tail,L=p.head,ne=p.tail,H=at(k,L.key),Q=at(g,B.key),ce=nn(b,B.key);if(Q.isOk()&&H.isOk()&&ce)e=G,t=k,r=p,n=g,i=b,s=v-me(B),o=y,u=w,a=j,c=O,f=E,$=T,h=q,x=re;else if(Q.isOk()&&H.isOk()){let U=H[0],z=me(L),J=w-v,Z=ms(L.key,J,z),ie=_(Z,E),ke=Hi(b,L.key),Ee=v+z;e=_(U,m),t=k,r=p,n=g,i=ke,s=Ee,o=y,u=w,a=j,c=O,f=ie,$=T,h=q,x=re}else if(!Q.isOk()&&H.isOk()){let U=me(B),z=v-U,J=Vt(re,O,w,B),Z=hs(B.key,U),ie=_(Z,E);e=G,t=k,r=p,n=g,i=b,s=z,o=y,u=w,a=j,c=O,f=ie,$=T,h=q,x=J}else if(Q.isOk()&&!H.isOk()){let U=w-v,z=me(L),J=yr(re,q,O,w,L),Z=Rn(l([L]),U),ie=_(Z,E);e=m,t=k,r=ne,n=g,i=b,s=v+z,o=y,u=w+z,a=j,c=O,f=ie,$=T,h=q,x=J}else{let U=me(B),z=me(L),J=Fn(w-v,U,L),Z,ke=Vt(re,O,w,B);Z=yr(ke,q,O,w,L);let Ee=Z;e=G,t=k,r=ne,n=g,i=b,s=v-U+z,o=y,u=w+z,a=j,c=O,f=_(J,E),$=T,h=q,x=Ee}}else if(m.atLeastLength(1)&&m.head instanceof ue&&p.atLeastLength(1)&&p.head instanceof ue){let B=m.head,G=m.tail,L=p.head,ne=p.tail,H=w+1,Q=B.children_count,ce=L.children_count,U=Ge(q,L.mapper),z=Hn(B.children,B.keyed_children,L.children,L.keyed_children,It(),v,0,H,-1,O,S,T,U,re),J;if(z.patch.removed>0){let ke=H+ce-v,Ee=xs(ke,z.patch.removed);J=je(z.patch.changes,_(Ee,E))}else J=je(z.patch.changes,E);let ie=J;e=G,t=k,r=ne,n=g,i=b,s=v+ce-Q,o=y,u=H+ce,a=j,c=O,f=ie,$=z.patch.children,h=q,x=z.events}else if(m.atLeastLength(1)&&m.head instanceof be&&p.atLeastLength(1)&&p.head instanceof be&&m.head.namespace===p.head.namespace&&m.head.tag===p.head.tag){let B=m.head,G=m.tail,L=p.head,ne=p.tail,H=Ge(q,L.mapper),Q=Re(O,w,L.key),ce=Du(re,L.namespace,L.tag,Q),U=ws(ce,Q,H,re,B.attributes,L.attributes,S,S),z=U.added,J=U.removed,Z=U.events,ie;z.hasLength(0)&&J.hasLength(0)?ie=S:ie=l([Pn(z,J)]);let ke=ie,Ee=Hn(B.children,B.keyed_children,L.children,L.keyed_children,It(),0,0,0,w,Q,ke,S,H,Z),ot,Pe=Ee.patch;Pe instanceof Ke&&Pe.removed===0&&Pe.changes.hasLength(0)&&Pe.children.hasLength(0)?ot=T:ot=_(Ee.patch,T);let zr=ot;e=G,t=k,r=ne,n=g,i=b,s=v,o=y,u=w+1,a=j,c=O,f=E,$=zr,h=q,x=Ee.events}else if(m.atLeastLength(1)&&m.head instanceof Te&&p.atLeastLength(1)&&p.head instanceof Te&&m.head.content===p.head.content){let B=m.head,G=m.tail,L=p.head,ne=p.tail;e=G,t=k,r=ne,n=g,i=b,s=v,o=y,u=w+1,a=j,c=O,f=E,$=T,h=q,x=re}else if(m.atLeastLength(1)&&m.head instanceof Te&&p.atLeastLength(1)&&p.head instanceof Te){let B=m.tail,G=p.head,L=p.tail,ne=Mn(w,0,l([ds(G.content)]),S);e=B,t=k,r=L,n=g,i=b,s=v,o=y,u=w+1,a=j,c=O,f=E,$=_(ne,T),h=q,x=re}else if(m.atLeastLength(1)&&m.head instanceof Oe&&p.atLeastLength(1)&&p.head instanceof Oe){let B=m.head,G=m.tail,L=p.head,ne=p.tail,H=Ge(q,L.mapper),Q=Re(O,w,L.key),ce=ws(!1,Q,H,re,B.attributes,L.attributes,S,S),U=ce.added,z=ce.removed,J=ce.events,Z;U.hasLength(0)&&z.hasLength(0)?Z=S:Z=l([Pn(U,z)]);let ie=Z,ke;B.inner_html===L.inner_html?ke=ie:ke=_(_s(L.inner_html),ie);let ot=ke,Pe;ot.hasLength(0)?Pe=T:Pe=_(Mn(w,0,ot,l([])),T);let zr=Pe;e=G,t=k,r=ne,n=g,i=b,s=v,o=y,u=w+1,a=j,c=O,f=E,$=zr,h=q,x=J}else{let B=m.head,G=m.tail,L=p.head,ne=p.tail,H=me(B),Q=me(L),ce=Fn(w-v,H,L),U,J=Vt(re,O,w,B);U=yr(J,q,O,w,L);let Z=U;e=G,t=k,r=ne,n=g,i=b,s=v-H+Q,o=y,u=w+Q,a=j,c=O,f=_(ce,E),$=T,h=q,x=Z}}}function Vn(e,t,r){return Hn(l([t]),_e(),l([r]),_e(),It(),0,0,0,0,xn,S,S,le,bs(e))}var jr=class{offset=0;#e=null;#s=()=>{};#l=!1;constructor(t,r,{useServerEvents:n=!1}={}){this.#e=t,this.#s=r,this.#l=n}mount(t){vr(this.#e,this.#u(t))}#r=[];push(t){let r=this.offset;r&&(Ie(t.changes,n=>{switch(n.kind){case $r:case hr:n.before=(n.before|0)+r;break;case wr:case xr:n.from=(n.from|0)+r;break}}),Ie(t.children,n=>{n.index=(n.index|0)+r})),this.#r.push({node:this.#e,patch:t}),this.#o()}#o(){let t=this;for(;t.#r.length;){let{node:r,patch:n}=t.#r.pop();Ie(n.changes,i=>{switch(i.kind){case $r:t.#a(r,i.children,i.before);break;case hr:t.#p(r,i.key,i.before,i.count);break;case Dn:t.#d(r,i.key,i.count);break;case wr:t.#t(r,i.from,i.count);break;case xr:t.#c(r,i.from,i.count,i.with);break;case In:t.#i(r,i.content);break;case qn:t.#_(r,i.inner_html);break;case Un:t.#f(r,i.added,i.removed);break}}),n.removed&&t.#t(r,r.childNodes.length-n.removed,n.removed),Ie(n.children,i=>{t.#r.push({node:Yt(r,i.index),patch:i})})}}#a(t,r,n){let i=vs();Ie(r,s=>{let o=this.#u(s);Yn(t,o),vr(i,o)}),Wn(t,i,Yt(t,n))}#p(t,r,n,i){let s=js(t,r),o=Yt(t,n);for(let u=0;u<i&&s!==null;++u){let a=s.nextSibling;Vi?t.moveBefore(s,o):Wn(t,s,o),s=a}}#d(t,r,n){this.#n(t,js(t,r),n)}#t(t,r,n){this.#n(t,Yt(t,r),n)}#n(t,r,n){for(;n-- >0&&r!==null;){let i=r.nextSibling,s=r[K].key;s&&t[K].keyedChildren.delete(s);for(let[o,{timeout:u}]of r[K].debouncers)clearTimeout(u);t.removeChild(r),r=i}}#c(t,r,n,i){this.#t(t,r,n);let s=this.#u(i);Yn(t,s),Wn(t,s,Yt(t,r))}#i(t,r){t.data=r??""}#_(t,r){t.innerHTML=r??""}#f(t,r,n){Ie(n,i=>{let s=i.name;t[K].handlers.has(s)?(t.removeEventListener(s,Ls),t[K].handlers.delete(s),t[K].throttles.has(s)&&t[K].throttles.delete(s),t[K].debouncers.has(s)&&(clearTimeout(t[K].debouncers.get(s).timeout),t[K].debouncers.delete(s))):(t.removeAttribute(s),Es[s]?.removed?.(t,s))}),Ie(r,i=>{this.#h(t,i)})}#u(t){switch(t.kind){case kn:{let r=ys(t);return this.#m(r,t),this.#a(r,t.children,0),r}case jn:{let r=ks(t.content);return qe(r,t.key),r}case yn:{let r=vs(),n=ks();return qe(n,t.key),vr(r,n),Ie(t.children,i=>{vr(r,this.#u(i))}),r}case fs:{let r=ys(t);return this.#m(r,t),this.#_(r,t.inner_html),r}}}#m(t,{attributes:r}){Ie(r,n=>this.#h(t,n))}#h(t,r){let n=t[K];switch(r.kind){case ln:{let i=r.name,s=r.value??"";s!==t.getAttribute(i)&&t.setAttribute(i,s),Es[i]?.added?.(t,s);break}case ns:t[r.name]=r.value;break;case an:{n.handlers.has(r.name)||t.addEventListener(r.name,Ls,{passive:!r.prevent_default});let i=r.prevent_default,s=r.stop_propagation,o=r.immediate,u=Array.isArray(r.include)?r.include:[];if(r.limit?.kind===fn){let a=n.throttles.get(r.name)??{last:0,delay:r.limit.delay};n.throttles.set(r.name,a)}if(r.limit?.kind===cn){let a=n.debouncers.get(r.name)??{timeout:null,delay:r.limit.delay};n.debouncers.set(r.name,a)}n.handlers.set(r.name,a=>{i&&a.preventDefault(),s&&a.stopPropagation();let c=a.type,f="",$=a.currentTarget;for(;$!==this.#e;){let x=$[K].key,m=$.parentNode;if(x)f=`${wn}${x}${f}`;else{let k=m.childNodes,p=[].indexOf.call(k,$);m===this.#e&&(p-=this.offset),f=`${$n}${p}${f}`}$=m}f=f.slice(1);let h=this.#l?Fu(a,u):a;if(n.throttles.has(c)){let x=n.throttles.get(c),m=Date.now(),k=x.last||0;m>k+x.delay?(x.last=m,this.#s(h,f,c,o)):a.preventDefault()}else if(n.debouncers.has(c)){let x=n.debouncers.get(c);clearTimeout(x.timeout),x.timeout=setTimeout(()=>{this.#s(h,f,c,o)},x.delay)}else this.#s(h,f,c,o)});break}}}},Ie=(e,t)=>{if(Array.isArray(e))for(let r=0;r<e.length;r++)t(e[r]);else if(e)for(e;e.tail;e=e.tail)t(e.head)},vr=(e,t)=>e.appendChild(t),Wn=(e,t,r)=>e.insertBefore(t,r??null),ys=({key:e,tag:t,namespace:r})=>{let n=Le.createElementNS(r||ur,t);return qe(n,e),n},ks=e=>Le.createTextNode(e??""),vs=()=>Le.createDocumentFragment(),Yt=(e,t)=>e.childNodes[t|0],K=Symbol("lustre"),qe=(e,t="")=>{switch(e.nodeType){case lr:case qt:e[K]={key:t,keyedChildren:new Map,handlers:new Map,throttles:new Map,debouncers:new Map};break;case ar:e[K]={key:t,debouncers:new Map};break}},Yn=(e,t)=>{if(t.nodeType===qt){for(t=t.firstChild;t;t=t.nextSibling)Yn(e,t);return}let r=t[K].key;r&&e[K].keyedChildren.set(r,new WeakRef(t))},js=(e,t)=>e[K].keyedChildren.get(t).deref(),Ls=e=>{let r=e.currentTarget[K].handlers.get(e.type);e.type==="submit"&&(e.detail??={},e.detail.formData=[...new FormData(e.target).entries()]),r(e)},Fu=(e,t=[])=>{let r={};(e.type==="input"||e.type==="change")&&t.push("target.value"),e.type==="submit"&&t.push("detail.formData");for(let n of t){let i=n.split(".");for(let s=0,o=e,u=r;s<i.length;s++){if(s===i.length-1){u[i[s]]=o[i[s]];break}u=u[i[s]]??={},o=o[i[s]]}}return r},Os=e=>({added(t){t[e]=!0},removed(t){t[e]=!1}}),Ru=e=>({added(t,r){t[e]=r}}),Es={checked:Os("checked"),selected:Os("selected"),value:Ru("value"),autofocus:{added(e){queueMicrotask(()=>e.focus?.())}},autoplay:{added(e){try{e.play?.()}catch(t){console.error(t)}}}};var Bs=e=>{let t=Cs(e);if(t===null||t.children instanceof ve){let r=Ss();return qe(r),e.appendChild(r),Ts()}else{if(t.children instanceof fe&&t.children.tail instanceof ve)return t.children.head;{let r=Ss();return qe(r),e.insertBefore(r,e.firstChild),Xn(t.children)}}},Ss=()=>Le.createTextNode(""),Cs=e=>{switch(e.nodeType){case lr:{let t=e.getAttribute("data-lustre-key");qe(e,t),t&&e.removeAttribute("data-lustre-key");let r=e.localName,n=e.namespaceURI,i=!n||n===ur;i&&Gu.includes(r)&&Hu(r,e);let s=Vu(e),o=As(e),u=i?ge(r,s,o):Jn(n,r,s,o);return t?On(t,u):u}case ar:return qe(e),Lr(e.data);case qt:return qe(e),e.childNodes.length>0?Xn(As(e)):null;default:return null}},Gu=["input","select","textarea"],Hu=(e,t)=>{let r=t.value,n=t.checked;e==="input"&&t.type==="checkbox"&&!n||e==="input"&&t.type==="radio"&&!n||t.type!=="checkbox"&&t.type!=="radio"&&!r||queueMicrotask(()=>{t.value=r,t.checked=n,t.dispatchEvent(new Event("input",{bubbles:!0})),t.dispatchEvent(new Event("change",{bubbles:!0})),Le.activeElement!==t&&t.dispatchEvent(new Event("blur",{bubbles:!0}))})},As=e=>{let t=S,r=e.lastChild;for(;r;){let n=Cs(r),i=r.previousSibling;n?t=new fe(n,t):e.removeChild(r),r=i}return t},Vu=e=>{let t=e.attributes.length,r=S;for(;t-- >0;)r=new fe(Wu(e.attributes[t]),r);return r},Wu=e=>{let t=e.localName,r=e.value;return pr(t,r)};var Xt=()=>!!Le;var Kn=(e,t)=>e===t;var Jt=class{constructor(t,[r,n],i,s){this.root=t,this.#e=r,this.#s=i,this.#l=s,this.#a=new jr(this.root,(o,u,a)=>{let[c,f]=Or(this.#o,u,a,o);this.#o=c,f.isOk()&&this.dispatch(f[0],!1)}),this.#r=Bs(this.root),this.#o=Qn(),this.#i=!0,this.#f(n)}root=null;set offset(t){this.#a.offset=t}dispatch(t,r=!1){if(this.#i||=r,this.#p)this.#d.push(t);else{let[n,i]=this.#l(this.#e,t);this.#e=n,this.#f(i)}}emit(t,r){(this.root.host??this.root).dispatchEvent(new CustomEvent(t,{detail:r,bubbles:!0,composed:!0}))}#e;#s;#l;#r;#o;#a;#p=!1;#d=[];#t=S;#n=S;#c=null;#i=!1;#_={dispatch:(t,r)=>this.dispatch(t,r),emit:(t,r)=>this.emit(t,r),select:()=>{},root:()=>this.root};#f(t){for(this.#p=!0;;){for(let r=t.synchronous;r.tail;r=r.tail)r.head(this.#_);if(this.#t=Ns(this.#t,t.before_paint),this.#n=Ns(this.#n,t.after_paint),!this.#d.length)break;[this.#e,t]=this.#l(this.#e,this.#d.shift())}this.#p=!1,this.#i?(cancelAnimationFrame(this.#c),this.#u()):this.#c||(this.#c=requestAnimationFrame(()=>{this.#u()}))}#u(){this.#i=!1,this.#c=null;let t=this.#s(this.#e),{patch:r,events:n}=Vn(this.#o,this.#r,t);if(this.#o=n,this.#r=t,this.#a.push(r),this.#t instanceof fe){let i=zs(this.#t);this.#t=S,queueMicrotask(()=>{this.#i=!0,this.#f(i)})}if(this.#n instanceof fe){let i=zs(this.#n);this.#n=S,requestAnimationFrame(()=>{this.#i=!0,this.#f(i)})}}};function zs(e){return{synchronous:e,after_paint:S,before_paint:S}}function Ns(e,t){return e instanceof ve?t:t instanceof ve?e:je(e,t)}var ze=class extends d{constructor(t,r,n){super(),this.handlers=t,this.dispatched_paths=r,this.next_dispatched_paths=n}};function Qn(){return new ze(_e(),S,S)}function bs(e){return new ze(e.handlers,e.next_dispatched_paths,S)}function Us(e,t,r){return mn(e,gn(t,r))}function br(e,t,r){let n=Us(e.handlers,t,r),i=e;return new ze(n,i.dispatched_paths,i.next_dispatched_paths)}function Ms(e,t,r){return de(r,e,(n,i)=>{if(i instanceof te){let s=i.name;return Us(n,t,s)}else return n})}function Or(e,t,r,n){let i=_(t,e.next_dispatched_paths),s,o=e;s=new ze(o.handlers,o.dispatched_paths,i);let u=s,a=at(u.handlers,t+bn+r);if(a.isOk()){let c=a[0];return[u,ut(n,c)]}else return[u,new C(l([]))]}function gr(e,t){return ls(t,e.dispatched_paths)}function Ps(e,t,r,n,i){return Rt(e,gn(r,n),tn(i,t))}function Ht(e,t,r,n,i){let s=Ps(e.handlers,t,r,n,i),o=e;return new ze(s,o.dispatched_paths,o.next_dispatched_paths)}function Is(e,t,r,n){return de(n,e,(i,s)=>{if(s instanceof te){let o=s.name,u=s.handler;return Ps(i,t,r,o,u)}else return i})}function Ge(e,t){let r=Kn(e,le),n=Kn(t,le);return n?e:r&&!n?t:i=>e(t(i))}function qs(e,t,r,n){for(;;){let i=e,s=t,o=r,u=n;if(u.hasLength(0))return i;{let a=u.head,c=u.tail;e=Ds(i,s,o,a),t=s,r=o+me(a),n=c}}}function Ds(e,t,r,n){if(n instanceof be){let i=n.attributes,s=n.children,o=Re(t,r,n.key),a=Ms(e,o,i);return qs(a,o,0,s)}else if(n instanceof ue){let i=n.children;return qs(e,t,r+1,i)}else if(n instanceof Oe){let i=n.attributes,s=Re(t,r,n.key);return Ms(e,s,i)}else return e}function Vt(e,t,r,n){let i=Ds(e.handlers,t,r,n),s=e;return new ze(i,s.dispatched_paths,s.next_dispatched_paths)}function Zn(e,t,r,n,i){for(;;){let s=e,o=t,u=r,a=n,c=i;if(c.hasLength(0))return s;{let f=c.head,$=c.tail;e=Fs(s,o,u,a,f),t=o,r=u,n=a+me(f),i=$}}}function Fs(e,t,r,n,i){if(i instanceof be){let s=i.attributes,o=i.children,u=Re(r,n,i.key),a=Ge(t,i.mapper),f=Is(e,a,u,s);return Zn(f,a,u,0,o)}else if(i instanceof ue){let s=i.children,o=Ge(t,i.mapper),u=n+1;return Zn(e,o,r,u,s)}else if(i instanceof Oe){let s=i.attributes,o=Re(r,n,i.key),u=Ge(t,i.mapper);return Is(e,u,o,s)}else return e}function yr(e,t,r,n,i){let s=Fs(e.handlers,t,r,n,i),o=e;return new ze(s,o.dispatched_paths,o.next_dispatched_paths)}function gs(e,t,r,n,i){let s=Zn(e.handlers,t,r,n,i),o=e;return new ze(s,o.dispatched_paths,o.next_dispatched_paths)}function ge(e,t,r){return vn("",le,"",e,t,r,_e(),!1,!1)}function Jn(e,t,r,n){return vn("",le,e,t,r,n,_e(),!1,!1)}function Lr(e){return Ln("",le,e)}function Ts(){return Ln("",le,"")}function Yu(e,t){for(;;){let r=e,n=t;if(r.hasLength(0))return n;if(r.atLeastLength(1)&&r.head instanceof ue){let i=r.head.children_count;e=r.tail,t=n+i}else e=r.tail,t=n+1}}function Xn(e){return cs("",le,e,_e(),Yu(e,0))}function F(e){return Lr(e)}function Qe(e,t){return ge("h1",e,t)}function Rs(e,t){return ge("h4",e,t)}function ei(e,t){return ge("main",e,t)}function Gs(e,t){return ge("nav",e,t)}function ae(e,t){return ge("div",e,t)}function Kt(e,t){return ge("p",e,t)}function ct(e,t){return ge("span",e,t)}function ti(e,t){return ge("button",e,t)}var Ze=class extends d{constructor(t){super(),this.message=t}},ft=class extends d{constructor(t,r){super(),this.name=t,this.data=r}};var et=class extends d{};var ni=class extends d{constructor(t,r,n,i,s,o,u,a){super(),this.open_shadow_root=t,this.adopt_styles=r,this.attributes=n,this.properties=i,this.is_form_associated=s,this.on_form_autofill=o,this.on_form_reset=u,this.on_form_restore=a}};function Vs(e){let t=new ni(!1,!0,or(),or(),!1,cr,cr,cr);return de(e,t,(r,n)=>n.apply(r))}var ii=class e{static start({init:t,update:r,view:n},i,s){if(!Xt())return new C(new pt);let o=i instanceof HTMLElement?i:Le.querySelector(i);return o?new N(new e(o,t(s),r,n)):new C(new Er(i))}#e;constructor(t,[r,n],i,s){this.#e=new Jt(t,[r,n],s,i)}send(t){switch(t.constructor){case Ze:{this.dispatch(t.message,!1);break}case ft:{this.emit(t.name,t.data);break}case et:break}}dispatch(t,r){this.#e.dispatch(t,r)}emit(t,r){this.#e.emit(t,r)}},Ws=ii.start;var si=class extends d{constructor(t,r,n,i){super(),this.init=t,this.update=r,this.view=n,this.config=i}};var Er=class extends d{constructor(t){super(),this.selector=t}},pt=class extends d{};function nl(e,t,r){return new si(e,t,r,Vs(S))}function Ys(e,t,r){return nl(s=>[e(s),dn()],(s,o)=>[t(s,o),dn()],r)}function Js(e,t,r){return Fi(!Xt(),new C(new pt),()=>Ws(e,t,r))}var tt=class extends d{constructor(t,r,n,i,s,o){super(),this.health=t,this.points=r,this.credits=n,this.starter_orbs=i,this.purchased_orbs=s,this.curses=o}},Sr=class extends d{constructor(t){super(),this.value=t}},dt=class extends d{constructor(t){super(),this.value=t}},_t=class extends d{constructor(t){super(),this.value=t}},rt=class extends d{constructor(t){super(),this.orbs=t}},R=class extends d{constructor(t){super(),this[0]=t}},nt=class extends d{constructor(t){super(),this[0]=t}},oi=class extends d{},ui=class extends d{constructor(t){super(),this.curses=t}},li=class extends d{},Ar=class extends d{constructor(t){super(),this.items=t}},ai=class extends d{constructor(t,r){super(),this.item=t,this.price=r}},Br=class extends d{constructor(t,r,n){super(),this.current_level=t,this.current_round=r,this.milestone=n}},it=class extends d{constructor(t,r,n){super(),this.player=t,this.level=r,this.market=n}},st=class extends d{},Ue=class extends d{constructor(t){super(),this[0]=t}},He=class extends d{constructor(t){super(),this[0]=t}},mt=class extends d{constructor(t){super(),this[0]=t}},ht=class extends d{constructor(t){super(),this[0]=t}};var Ve=class extends d{},xt=class extends d{},$t=class extends d{},wt=class extends d{},bt=class extends d{constructor(t){super(),this[0]=t}};function Qt(e,t){return Mi(e,t)}function sl(){let e=l([Qt(new R(1),4),Qt(new R(2),3),Qt(new R(3),2),Qt(new nt(1),3),Qt(new nt(2),2)]);return Xr(e)}function ci(){let e=new Sr(5),t=new dt(0),r=new _t(0),n,i=sl(),s=Qr(i);n=new rt(s);let o=n,u=new rt(l([])),a=new ui(l([new li]));return new tt(e,t,r,o,u,a)}function ye(e,t){return new ai(e,new _t(t))}function ol(){return l([ye(new R(1),2),ye(new R(1),2),ye(new R(1),2),ye(new R(1),2),ye(new R(2),5),ye(new R(2),5),ye(new R(2),5),ye(new R(3),8),ye(new R(3),8),ye(new R(5),20),ye(new R(5),20),ye(new R(10),50)])}function ul(){let e=ol(),t=zi(e,(r,n)=>[n,r]);return new Ar(t)}function ll(){return new Br(1,1,new dt(10))}function fi(){let e=ci(),t=ul(),r=ll();return new it(e,r,t)}function Xs(e){let t=e.player,r=t.starter_orbs.orbs,n;if(r.hasLength(0))n=[new oi,l([])];else{let g=r.head,b=r.tail;n=[g,b]}let i=n,s=i[0],o=i[1],u;if(s instanceof nt){let g=s[0];u=[t.health.value-g,t.points.value]}else if(s instanceof R){let g=s[0];u=[t.health.value,t.points.value+g]}else u=[t.health.value,t.points.value];let a=u,c=a[0],f=a[1],$,h=t;$=new tt(new Sr(c),new dt(f),h.credits,new rt(o),h.purchased_orbs,h.curses);let x=$,m,k=e;return m=new it(x,k.level,k.market),m}function Ks(e){let t=e.player,r=e.level,n=t.health.value,i=t.points.value,s=r.milestone.value,o;return n<=0?o=c=>new ht(c):i>=s?o=f=>new mt(f):o=f=>new Ue(f),o(e)}function Qs(e){let t=e.player,r=t.points.value+t.credits.value,n,i=t;n=new tt(i.health,i.points,new _t(r),i.starter_orbs,i.purchased_orbs,i.curses);let s=n,o=e;return new it(s,o.level,o.market)}function Zs(e){let t=e.player,r=e.level,n,i=t.purchased_orbs.orbs,s=je(i,ci().starter_orbs.orbs),o=Qr(s);n=new rt(o);let u=n,a,c=ci();a=new tt(c.health,c.points,t.credits,u,t.purchased_orbs,t.curses);let f=a,$,h=r;$=new Br(r.current_level+1,h.current_round,new dt(r.milestone.value+5));let x=$,m=e;return new it(f,x,m.market)}function eo(e,t){let r=e.player,n=e.market,i=t[0],o=t[1].price,u;if(!(r.credits.value>=o.value))u=[r.credits.value,n.items,new ee];else{let v,y=(()=>{let E=n.items;return Ii(E,i)})();if(!y.isOk())v=[n.items,new ee];else{let E=y[0][0];v=[y[0][1],new se(E)]}let w=v,j=w[0],O=w[1];u=[r.credits.value-o.value,j,O]}let c=u,f=c[0],$=c[1],h=c[2],x;if(h instanceof ee)x=r.purchased_orbs.orbs;else{let v=h[0],y=r.purchased_orbs.orbs;x=Ct(y,v.item)}let m=x,k,p=r;k=new tt(p.health,p.points,new _t(f),p.starter_orbs,new rt(m),p.curses);let g=k,b=e;return new it(g,b.level,new Ar($))}function al(e){return e==="input"||e==="change"||e==="focus"||e==="focusin"||e==="focusout"||e==="blur"?!0:e==="select"}function cl(e,t){return is(e,t,S,!1,!1,al(e),new lt(0))}function di(e){return cl("click",en(e))}function gt(e,t){return ti(l([A("px-8 py-3 mt-4 font-semibold text-sm border-2 border-black rounded tracking-wider uppercase hover:bg-black hover:text-white focus:outline-none focus:ring-2 focus:ring-white focus:ring-offset-2 focus:ring-offset-black transition-colors duration-150 ease-in-out"),di(e)]),l([F(t)]))}function pl(e){let t="w-4 h-6",r="bg-black",n="bg-white border border-black";return ae(l([A(t+" "+(e?r:n))]),l([]))}function dl(e){let t=5,r=e.value,n,i=Ni(1,t);n=Ce(i,o=>pl(o<=r));let s=n;return ae(l([A("flex flex-row space-x-1 items-center")]),Ct(s,ae(l([A("text-md font-semibold text-black tracking-tight")]),l([F("HEALTH: ")]))))}function _i(e){let t=e.health,r=e.credits;return Gs(l([A("bg-white px-4 sm:px-6 py-3 flex justify-between items-center border-b-2 border-black sticky top-0 z-10")]),l([dl(t),ae(l([A("text-md font-semibold text-black tracking-tight")]),l([F("CREDITS: $"),ct(l([A("font-bold")]),l([(()=>{let n=W(r.value);return F(n)})()]))]))]))}function Cr(e){return ae(l([A("w-24 h-24 flex items-center justify-center border-2 border-black bg-white")]),l([ct(l([A("text-xl font-semibold text-black")]),l([F(e)]))]))}function to(e){let t=e[1],r,n=t.price.value;r=W(n);let i=r,s,o=t.item;if(o instanceof nt){let f=o[0];s=["Bomb",W(f)]}else if(o instanceof R){let f=o[0];s=["Point",W(f)]}else s=["Empty",W(0)];let u=s,a=u[0],c=u[1];return ae(l([A("flex flex-col items-center justify-center p-2 border-2 border-black rounded bg-white hover:shadow-lg transition-shadow")]),l([ti(l([di(new bt(e)),A("flex flex-col items-center space-y-1 w-full")]),l([Cr((()=>{let f=l([a," ",c]);return rr(f)})()),Rs(l([A("text-sm font-medium text-black mt-1")]),l([F("Cost: "+i)]))]))]))}function mi(e,t){return ae(l([A("bg-white text-black min-h-screen flex flex-col "+de(e,"",(r,n)=>r+" "+n))]),t)}function Tr(e,t){return mi((()=>{let r=l(["items-center justify-center p-8"]);return je(r,e)})(),l([ae(l([A("flex flex-col items-center text-center space-y-8")]),t)]))}function ro(){return Tr(l([]),l([Qe(l([A("text-6xl font-bold text-black tracking-tight")]),l([F("MOON BAG")])),gt(new Ve,"Start Game")]))}function no(e){let t=e.player,r=e.level,i=t.points.value,o=r.milestone.value;return mi(l([]),l([_i(t),ei(l([A("flex-grow flex flex-col items-center justify-center p-8 space-y-6")]),l([Qe(l([A("text-4xl font-semibold text-black mb-4")]),l([F("LEVEL "+W(r.current_level))])),ae(l([A("flex flex-row space-x-8 mb-6")]),l([ae(l([A("flex flex-col items-center")]),l([ct(l([A("text-sm text-black mb-1 uppercase tracking-wider")]),l([F("Points")])),Cr(W(i))])),ae(l([A("flex flex-col items-center")]),l([ct(l([A("text-sm text-black mb-1 uppercase tracking-wider")]),l([F("Milestone")])),Cr(W(o))]))])),gt(new xt,"Pull Orb")]))]))}function io(){return Tr(l([]),l([Qe(l([A("text-5xl font-bold text-black mb-2")]),l([F("YOU WON!")])),Kt(l([A("text-lg text-black mb-4")]),l([F("Congratulations on reaching the milestone!")])),gt(new $t,"Visit the Market")]))}function so(){return Tr(l([]),l([Qe(l([A("text-5xl font-bold text-black mb-2")]),l([F("GAME OVER")])),Kt(l([A("text-lg text-black mb-4")]),l([F("Better luck next time!")])),gt(new Ve,"Restart")]))}function oo(e){let t=e.player,n=e.market.items;return mi(l([]),l([_i(t),ei(l([A("flex-grow flex flex-col items-center p-8 space-y-6")]),l([Qe(l([A("text-4xl font-semibold text-black mb-6")]),l([F("Market")])),Ti(n)?Kt(l([A("text-lg text-black")]),l([F("The market is currently empty.")])):ae(l([A("grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-6")]),Ce(n,to)),gt(new wt,"Next Round")]))]))}function uo(){return Tr(l([]),l([Qe(l([A("text-5xl font-bold text-black")]),l([F("404")])),Kt(l([A("text-xl text-black")]),l([F("Page Not Found")]))]))}function hl(e){return new st}function xl(e,t){if(e instanceof st&&t instanceof Ve)return new Ue(fi());if(e instanceof ht&&t instanceof Ve)return new Ue(fi());if(e instanceof Ue&&t instanceof xt){let n=e[0],i=Xs(n);return Ks(i)}else if(e instanceof mt&&t instanceof $t){let n=e[0],i=Qs(n);return new He(i)}else if(e instanceof He&&t instanceof bt){let r=e[0],n=t[0],i=eo(r,n);return new He(i)}else if(e instanceof He&&t instanceof wt){let n=e[0],i=Zs(n);return new Ue(i)}else return new st}function $l(e){if(e instanceof st)return ro();if(e instanceof Ue){let t=e[0];return no(t)}else{if(e instanceof mt)return io();if(e instanceof ht)return so();if(e instanceof He){let t=e[0];return oo(t)}else return uo()}}function lo(){let e=Ys(hl,xl,$l),t=Js(e,"#app",void 0);if(!t.isOk())throw Mr("let_assert","moonbag_gleam",15,"main","Pattern match failed, no pattern matched the value.",{value:t})}lo();
